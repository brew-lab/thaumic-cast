@layer tokens, base, components, utilities;

@layer tokens {
  :root {
    /* Default to dark mode; override with data-theme attribute for user preference */
    color-scheme: dark;

    /*
     * ═══════════════════════════════════════════════════════════════════════════
     * TIER 1: PRIMITIVE TOKENS - Raw OKLCH color values
     * ═══════════════════════════════════════════════════════════════════════════
     */

    /*
     * Gray scale - Open Props inspired 16-step progression
     * Customizable via --gray-hue and --gray-chroma
     * Mystical violet tint for thaumic/magical aesthetic
     */
    --gray-hue: 280;
    --gray-chroma: 0.02;
    --gray-0: oklch(99% var(--gray-chroma) var(--gray-hue));
    --gray-1: oklch(95% var(--gray-chroma) var(--gray-hue));
    --gray-2: oklch(88% var(--gray-chroma) var(--gray-hue));
    --gray-3: oklch(80% var(--gray-chroma) var(--gray-hue));
    --gray-4: oklch(74% var(--gray-chroma) var(--gray-hue));
    --gray-5: oklch(68% var(--gray-chroma) var(--gray-hue));
    --gray-6: oklch(63% var(--gray-chroma) var(--gray-hue));
    --gray-7: oklch(58% var(--gray-chroma) var(--gray-hue));
    --gray-8: oklch(53% var(--gray-chroma) var(--gray-hue));
    --gray-9: oklch(49% var(--gray-chroma) var(--gray-hue));
    --gray-10: oklch(43% var(--gray-chroma) var(--gray-hue));
    --gray-11: oklch(37% var(--gray-chroma) var(--gray-hue));
    --gray-12: oklch(31% var(--gray-chroma) var(--gray-hue));
    --gray-13: oklch(25% var(--gray-chroma) var(--gray-hue));
    --gray-14: oklch(18% var(--gray-chroma) var(--gray-hue));
    --gray-15: oklch(10% var(--gray-chroma) var(--gray-hue));

    /*
     * Font stacks
     */
    --font-sans: system-ui, -apple-system, sans-serif;
    --font-mono: ui-monospace, 'SF Mono', menlo, consolas, monospace;

    /*
     * Brand color hues - customize these to change the entire color scheme
     * Arcane neon palette for thaumic/magical aesthetic
     */
    --hue-primary: 285;
    --hue-error: 350;
    --hue-success: 175;
    --hue-warning: 55;
    --hue-info: 230;
    --hue-casting: 190;
    --chroma-vibrant: 0.28;
    --chroma-muted: 0.18;

    /*
     * ═══════════════════════════════════════════════════════════════════════════
     * TIER 2: SEMANTIC TOKENS - Purpose-based colors (light-dark pairs)
     * ═══════════════════════════════════════════════════════════════════════════
     */

    /* Backgrounds - dark mode uses gray-14/15, light mode uses gray-1/0 */
    --color-bg: light-dark(var(--gray-1), var(--gray-15));
    --color-surface: light-dark(var(--gray-0), var(--gray-14));
    --color-surface-inset: light-dark(var(--gray-1), var(--gray-15));
    --color-surface-hover: light-dark(
      oklch(50% 0.04 var(--hue-primary) / 10%),
      oklch(70% 0.04 var(--hue-primary) / 12%)
    );
    --color-overlay: light-dark(oklch(99% 0 0 / 50%), oklch(10% 0 0 / 50%));

    /* Borders */
    --color-border: light-dark(var(--gray-3), var(--gray-12));
    --color-border-subtle: light-dark(var(--gray-2), var(--gray-13));

    /* Text */
    --color-text: light-dark(var(--gray-14), var(--gray-1));
    --color-text-muted: light-dark(var(--gray-10), var(--gray-5));
    --color-text-disabled: light-dark(var(--gray-7), var(--gray-9));

    /* Primary (interactive) - blue */
    --color-primary: light-dark(
      oklch(50% var(--chroma-vibrant) var(--hue-primary)),
      oklch(65% var(--chroma-vibrant) var(--hue-primary))
    );
    --color-primary-hover: light-dark(
      oklch(45% var(--chroma-vibrant) var(--hue-primary)),
      oklch(60% var(--chroma-vibrant) var(--hue-primary))
    );
    --color-primary-active: light-dark(
      oklch(40% var(--chroma-vibrant) var(--hue-primary)),
      oklch(55% var(--chroma-vibrant) var(--hue-primary))
    );
    --color-on-primary: var(--gray-1);

    /* Error/Danger - red */
    --color-error: light-dark(
      oklch(55% var(--chroma-vibrant) var(--hue-error)),
      oklch(65% var(--chroma-vibrant) var(--hue-error))
    );
    --color-error-hover: light-dark(
      oklch(50% var(--chroma-vibrant) var(--hue-error)),
      oklch(60% var(--chroma-vibrant) var(--hue-error))
    );
    --color-error-active: light-dark(
      oklch(45% var(--chroma-vibrant) var(--hue-error)),
      oklch(55% var(--chroma-vibrant) var(--hue-error))
    );
    --color-on-error: oklch(100% 0 0);

    /* Success - green */
    --color-success: light-dark(
      oklch(45% var(--chroma-muted) var(--hue-success)),
      oklch(65% var(--chroma-muted) var(--hue-success))
    );
    --color-success-hover: light-dark(
      oklch(40% var(--chroma-muted) var(--hue-success)),
      oklch(60% var(--chroma-muted) var(--hue-success))
    );
    --color-on-success: var(--gray-1);

    /* Warning - yellow/gold */
    --color-warning: light-dark(
      oklch(55% var(--chroma-muted) var(--hue-warning)),
      oklch(85% var(--chroma-muted) var(--hue-warning))
    );
    --color-warning-hover: light-dark(
      oklch(50% var(--chroma-muted) var(--hue-warning)),
      oklch(80% var(--chroma-muted) var(--hue-warning))
    );
    --color-on-warning: var(--gray-14);

    /* Casting/Active state - orange/amber */
    --color-casting: light-dark(
      oklch(55% var(--chroma-muted) var(--hue-casting)),
      oklch(70% var(--chroma-muted) var(--hue-casting))
    );
    --color-casting-hover: light-dark(
      oklch(50% var(--chroma-muted) var(--hue-casting)),
      oklch(65% var(--chroma-muted) var(--hue-casting))
    );
    --color-on-casting: var(--gray-14);

    /* Info - blue */
    --color-info: light-dark(
      oklch(50% var(--chroma-muted) var(--hue-info)),
      oklch(70% var(--chroma-muted) var(--hue-info))
    );

    /* Focus ring */
    --color-focus: light-dark(
      oklch(50% var(--chroma-vibrant) var(--hue-primary)),
      oklch(70% var(--chroma-vibrant) var(--hue-primary))
    );

    /* Links */
    --color-link: var(--color-primary);
    --color-link-hover: var(--color-primary-hover);
    --color-link-visited: light-dark(
      oklch(45% var(--chroma-muted) var(--hue-primary)),
      oklch(60% var(--chroma-muted) var(--hue-primary))
    );

    /*
     * ═══════════════════════════════════════════════════════════════════════════
     * TIER 3: COMPONENT TOKENS - Scoped to UI components
     * ═══════════════════════════════════════════════════════════════════════════
     */

    /* Button: Primary */
    --button-primary-bg: var(--color-primary);
    --button-primary-bg-hover: var(--color-primary-hover);
    --button-primary-text: var(--color-on-primary);

    /* Button: Secondary */
    --button-secondary-bg: var(--color-surface);
    --button-secondary-bg-hover: var(--color-surface-hover);
    --button-secondary-text: var(--color-text);
    --button-secondary-border: var(--color-border);

    /* Button: Danger */
    --button-danger-bg: var(--color-error);
    --button-danger-bg-hover: var(--color-error-hover);
    --button-danger-text: var(--color-on-error);

    /* Button: Ghost */
    --button-ghost-bg: transparent;
    --button-ghost-bg-hover: var(--color-surface-hover);
    --button-ghost-text: var(--color-text-muted);
    --button-ghost-text-hover: var(--color-text);

    /* Button: Solid (icon buttons with filled background) */
    --button-solid-bg: var(--color-primary);
    --button-solid-bg-hover: var(--color-primary-hover);
    --button-solid-text: var(--color-on-primary);
    --button-solid-text-hover: var(--color-on-primary);

    /* Button: Disabled */
    --button-disabled-opacity: 0.5;

    /* Icon Button: Outline */
    --icon-button-outline-border: var(--color-border);
    --icon-button-outline-border-hover: var(--color-primary);

    /* Icon Button: Danger */
    --icon-button-danger-hover-bg: var(--color-error);
    --icon-button-danger-hover-text: var(--color-on-error);

    /* Input/Select */
    --input-bg: var(--color-bg);
    --input-text: var(--color-text);
    --input-border: var(--color-border);
    --input-border-focus: var(--color-focus);
    --input-placeholder: var(--color-text-muted);
    --input-disabled-opacity: 0.6;

    /* Card */
    --card-bg: var(--color-surface);
    --card-border: light-dark(
      oklch(70% 0.02 var(--hue-primary) / 10%),
      oklch(40% 0.02 var(--hue-primary) / 10%)
    );
    --card-shadow: var(--shadow-5);
    --card-radius: var(--radius-md);
    --card-padding: 0.75rem;
    --card-text: var(--color-text);
    --card-text-muted: var(--color-text-muted);

    /* Inset panels (recessed surfaces like placeholders, read-only displays) */
    --inset-bg: var(--color-surface-inset);

    /* Volume/Slider */
    --slider-track: var(--color-border);
    --slider-fill: var(--color-primary);
    --slider-thumb: var(--color-primary);

    /* Status indicators */
    --status-connected: var(--color-success);
    --status-disconnected: var(--color-error);
    --status-checking: var(--color-warning);
    --status-casting: var(--color-casting);

    /* Alert component */
    --alert-warning-bg: light-dark(
      oklch(75% var(--chroma-muted) var(--hue-warning) / 15%),
      oklch(55% var(--chroma-muted) var(--hue-warning) / 15%)
    );
    --alert-warning-border: light-dark(
      oklch(65% var(--chroma-muted) var(--hue-warning) / 40%),
      oklch(65% var(--chroma-muted) var(--hue-warning) / 30%)
    );
    --alert-warning-text: var(--color-warning);
    --alert-warning-icon: var(--color-warning);
    --alert-error-bg: light-dark(
      oklch(75% var(--chroma-muted) var(--hue-error) / 15%),
      oklch(55% var(--chroma-muted) var(--hue-error) / 15%)
    );
    --alert-error-border: light-dark(
      oklch(65% var(--chroma-muted) var(--hue-error) / 40%),
      oklch(65% var(--chroma-muted) var(--hue-error) / 30%)
    );
    --alert-error-text: var(--color-error);
    --alert-error-icon: var(--color-error);
    --alert-success-bg: light-dark(
      oklch(75% var(--chroma-muted) var(--hue-success) / 15%),
      oklch(55% var(--chroma-muted) var(--hue-success) / 15%)
    );
    --alert-success-border: light-dark(
      oklch(65% var(--chroma-muted) var(--hue-success) / 40%),
      oklch(65% var(--chroma-muted) var(--hue-success) / 30%)
    );
    --alert-success-text: var(--color-success);
    --alert-success-icon: var(--color-success);
    --alert-info-bg: light-dark(
      oklch(75% var(--chroma-muted) var(--hue-info) / 15%),
      oklch(55% var(--chroma-muted) var(--hue-info) / 15%)
    );
    --alert-info-border: light-dark(
      oklch(65% var(--chroma-muted) var(--hue-info) / 40%),
      oklch(65% var(--chroma-muted) var(--hue-info) / 30%)
    );
    --alert-info-text: var(--color-info);
    --alert-info-icon: var(--color-info);

    /* Device card status badges */
    --device-status-playing-bg: light-dark(
      oklch(65% var(--chroma-muted) var(--hue-success) / 15%),
      oklch(45% var(--chroma-muted) var(--hue-success) / 20%)
    );
    --device-status-playing-text: light-dark(
      oklch(40% var(--chroma-muted) var(--hue-success)),
      oklch(70% var(--chroma-muted) var(--hue-success))
    );
    --device-status-casting-bg: light-dark(
      oklch(60% var(--chroma-muted) var(--hue-primary) / 15%),
      oklch(50% var(--chroma-muted) var(--hue-primary) / 20%)
    );
    --device-status-casting-text: light-dark(
      oklch(45% var(--chroma-muted) var(--hue-primary)),
      oklch(75% var(--chroma-muted) var(--hue-primary))
    );

    /* Spacing */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;

    /* Radii */
    --radius-sm: 0.25rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;

    /*
     * Shadows - Open Props inspired layered shadows
     * Customize via --shadow-color and --shadow-strength
     */
    --shadow-color: var(--hue-primary);
    --shadow-strength: 2%;
    --shadow-1: 0 1px 2px -1px
      oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 9%));
    --shadow-2:
      0 3px 5px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 7px 14px -5px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 5%));
    --shadow-3:
      0 -1px 3px 0 oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 1px 2px -5px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 2px 5px -5px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 4%)),
      0 4px 12px -5px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 5%)),
      0 12px 15px -5px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 7%));
    --shadow-4:
      0 -2px 5px 0 oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 1px 1px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 2px 2px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 5px 5px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 4%)),
      0 9px 9px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 5%)),
      0 16px 16px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 6%));
    --shadow-5:
      0 -1px 2px 0 oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 2px 1px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 5px 5px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 10px 10px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 4%)),
      0 20px 20px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 5%)),
      0 40px 40px -2px oklch(20% 0.02 var(--shadow-color) / calc(var(--shadow-strength) + 7%));

    /*
     * ═══════════════════════════════════════════════════════════════════════════
     * MOTION TOKENS - Easing curves and durations (Open Props inspired)
     * ═══════════════════════════════════════════════════════════════════════════
     */

    /* Easing curves */
    --ease-out-1: cubic-bezier(0, 0, 0.75, 1);
    --ease-out-2: cubic-bezier(0, 0, 0.5, 1);
    --ease-out-3: cubic-bezier(0, 0, 0.3, 1);
    --ease-in-out-1: cubic-bezier(0.5, 0, 0.5, 1);
    --ease-in-out-2: cubic-bezier(0.45, 0, 0.55, 1);

    /* Durations */
    --duration-fast: 100ms;
    --duration-normal: 150ms;
    --duration-slow: 250ms;

    /* Semantic transitions (disabled by default, enabled via media query) */
    --transition-bg: none;
    --transition-color: none;
    --transition-opacity: none;
    --transition-transform: none;
  }

  /* Enable transitions only when user has no motion preference */
  @media (prefers-reduced-motion: no-preference) {
    :root {
      --transition-bg: background-color var(--duration-normal) var(--ease-out-2);
      --transition-color: color var(--duration-normal) var(--ease-out-2);
      --transition-opacity: opacity var(--duration-normal) var(--ease-out-1);
      --transition-transform: transform var(--duration-normal) var(--ease-out-3);
    }
  }
}

@layer base {
  html {
    scroll-behavior: smooth;
    caret-color: var(--color-primary);
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  body {
    font-family: var(--font-sans);
    background-color: var(--color-bg);
    color: var(--color-text);
    accent-color: var(--color-primary);
    margin: 0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  ::selection {
    background: var(--color-primary);
    color: var(--color-on-primary);
  }

  :where(h1, h2, h3, h4, h5, h6) {
    text-wrap: balance;
  }

  :where(p) {
    text-wrap: pretty;
  }

  :where(a) {
    color: var(--color-link);
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: var(--transition-color);
  }

  :where(a:hover) {
    color: var(--color-link-hover);
  }

  :where(a:visited) {
    color: var(--color-link-visited);
  }

  :where(a:focus-visible) {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
  }

  :where(
    a[href],
    area,
    button,
    input,
    label[for],
    select,
    summary,
    textarea,
    [tabindex]:not([tabindex*='-'])
  ) {
    -webkit-tap-highlight-color: transparent;
  }
}
